function [v] = LSimoveC_UC_Kin_Mecanum_W2V(rpm, positionFromRoot, wheelRadius) 

% FL :: rpm(1) 
% FR :: rpm(2) 
% BL :: rpm(3) 
% BR :: rpm(4) 

L1 = abs(positionFromRoot(1).x) + abs(positionFromRoot(1).y); 
L2 = abs(positionFromRoot(2).x) + abs(positionFromRoot(2).y); 
L3 = abs(positionFromRoot(3).x) + abs(positionFromRoot(3).y); 
L4 = abs(positionFromRoot(4).x) + abs(positionFromRoot(4).y); 

if L1 == L2 && L3 == L4 

    v(1) = 1/4 * wheelRadius * ( rpm(1) + rpm(2) + rpm(3) + rpm(4)); % in [mm/s]
    v(2) = wheelRadius * ( ...
         ( (L1/2 - L3/2)/(4*(L1/2 + L3/2)) - 1/4 ) * rpm(1) ...
        +( 1/4 - (L1/2 - L3/2)/(4*(L1/2 + L3/2)) ) * rpm(2) ...
        +( (L1/2 - L3/2)/(4*(L1/2 + L3/2)) + 1/4 ) * rpm(3) ...
        +(- (L1/2 - L3/2)/(4*(L1/2 + L3/2)) - 1/4 )* rpm(4)); % in [mm/s]
    v(3) = wheelRadius * (...
         (-1/(4*(L1/2 + L3/2)))* rpm(1) ...
        +(1/(4*(L1/2 + L3/2)))* rpm(2) ...
        +(-1/(4*(L1/2 + L3/2)))*rpm(3)  ...
        +(1/(4*(L1/2 + L3/2)))*rpm(4) );
    
% %     [ 1/4 - ((L1/2 + (L4)/2)*(L1/4 - L2/4 + L3/4 - L4/4))/(2*(L2/2 + L3/2)^2 + 2*(L1/2 + (L4)/2)*(L1/2 + L4/2)), ...
% %      ((L2/2 + L3/2)*(L1/4 - L2/4 + L3/4 - L4/4))/(2*(L2/2 + L3/2)^2 + 2*(L1/2 + (L4)/2)*(L1/2 + L4/2)) + 1/4,  ...
% %      1/4 - ((L2/2 + L3/2)*(L1/4 - L2/4 + L3/4 - L4/4))/(2*(L2/2 + L3/2)^2 + 2*(L1/2 + (L4)/2)*(L1/2 + L4/2)),   ...
% %      ((L1/2 + (L4)/2)*(L1/4 - L2/4 + L3/4 - L4/4))/(2*(L2/2 + L3/2)^2 + 2*(L1/2 + (L4)/2)*(L1/2 + L4/2)) + 1/4]
% %  
% % [ ((L1/2 + (L4)/2)*(L1/4 + L2/4 - L3/4 - L4/4))/(2*(L2/2 + L3/2)^2 + 2*(L1/2 + (L4)/2)*(L1/2 + L4/2)) - 1/4, ...
% %     1/4 - ((L2/2 + L3/2)*(L1/4 + L2/4 - L3/4 - L4/4))/(2*(L2/2 + L3/2)^2 + 2*(L1/2 + (L4)/2)*(L1/2 + L4/2)), ...
% %     ((L2/2 + L3/2)*(L1/4 + L2/4 - L3/4 - L4/4))/(2*(L2/2 + L3/2)^2 + 2*(L1/2 + (L4)/2)*(L1/2 + L4/2)) + 1/4, ...
% %     - ((L1/2 + (L4)/2)*(L1/4 + L2/4 - L3/4 - L4/4))/(2*(L2/2 + L3/2)^2 + 2*(L1/2 + (L4)/2)*(L1/2 + L4/2)) - 1/4]
% % 
% % [                                    -(L1/2 + (L4)/2)/(2*(L2/2 + L3/2)^2 + 2*(L1/2 + (L4)/2)*(L1/2 + L4/2)),   ...
% %     (L2/2 + L3/2)/(2*(L2/2 + L3/2)^2 + 2*(L1/2 + (L4)/2)*(L1/2 + L4/2)),              ...
% %     -(L2/2 + L3/2)/(2*(L2/2 + L3/2)^2 + 2*(L1/2 + (L4)/2)*(L1/2 + L4/2)),              ...
% %     (L1/2 + (L4)/2)/(2*(L2/2 + L3/2)^2 + 2*(L1/2 + (L4)/2)*(L1/2 + L4/2))]

    
end
    


